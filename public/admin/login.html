<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI Responder â€¢ Admin Login</title>
    <link rel="stylesheet" href="/admin/styles.css" />
  </head>
  <body>
    <div class="auth-wrap">
      <div class="auth-card" style="max-width:420px;width:100%">
        <div style="text-align:center;margin-bottom:14px">
          <div style="font-weight:700;font-size:22px;letter-spacing:.3px">AI Responder</div>
          <div class="small muted" style="margin-top:4px">Sign in to your control panel</div>
        </div>

        <div class="input-group" style="margin-top:12px">
          <label>Password</label>
          <div class="control">
            <span class="left-icon">ðŸ”’</span>
            <input id="pw" type="password" placeholder="Your admin password" autocomplete="current-password" />
            <button id="togglePw" type="button" class="right-btn" aria-label="Show password" title="Show/Hide Password">
              <svg id="eyeOpen" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
              </svg>
              <svg id="eyeClosed" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display:none">
                <path d="M3 3l18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M10.58 10.58A3 3 0 0012 15a3 3 0 002.42-4.42M9.88 5.09A10.43 10.43 0 0112 5c6.5 0 10 6 10 6a18.76 18.76 0 01-3.16 3.62M6.11 6.11A18.76 18.76 0 002 11s3.5 6 10 6a10.9 10.9 0 004.06-.76" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>

        <button id="loginBtn" class="full" style="margin-top:16px">Sign in</button>
        <div id="msg" class="error" style="margin-top:10px"></div>

        <div class="small muted" style="text-align:center;margin-top:16px">
          Protected area â€¢ Authorized users only
        </div>
      </div>
    </div>

    <script>
      const pw = document.getElementById('pw');
      const btn = document.getElementById('loginBtn');
      const msg = document.getElementById('msg');
      const toggle = document.getElementById('togglePw');

      async function doLogin(){
        msg.textContent = '';
        btn.classList.add('loading');
        btn.disabled = true;
        try {
          const res = await fetch('/api/login', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ password: pw.value }) });
          if (res.ok) {
            window.location.href = '/admin';
            return;
          }
          const j = await res.json().catch(()=>({error:'Login failed'}));
          msg.textContent = j.error || 'Login failed';
        } catch (e) {
          msg.textContent = 'Network error. Please try again.';
        } finally {
          btn.classList.remove('loading');
          btn.disabled = false;
        }
      }

      btn.addEventListener('click', doLogin);
      pw.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ doLogin(); }});
      pw.focus();

      toggle.addEventListener('click', ()=>{
        const isPw = pw.getAttribute('type') === 'password';
        pw.setAttribute('type', isPw ? 'text' : 'password');
        document.getElementById('eyeOpen').style.display = isPw ? 'none' : '';
        document.getElementById('eyeClosed').style.display = isPw ? '' : 'none';
      });
    </script>
  </body>
  
</html>
